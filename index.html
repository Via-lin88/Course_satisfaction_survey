<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èª²ç¨‹æ»¿æ„åº¦æš¨å­¸ç¿’å›é¥‹å•å·</title>
    
    <style>
        /* åŸºç¤æ¨£å¼ */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans TC", "PingFang TC", sans-serif;
            background-color: #f4f7f6;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* å•å·å®¹å™¨ */
        .survey-container {
            width: 100%;
            max-width: 750px;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            border: 1px solid #e0e0e0;
        }

        /* å•å·æ¨™é ­ */
        .survey-header {
            background-color: #0056b3; /* å¥‡ç¾è— (ç¤ºæ„) */
            color: white;
            padding: 30px;
            text-align: center;
        }

        .survey-header h1 {
            margin: 0;
            font-size: 26px;
        }

        /* å•å·ä»‹ç´¹æ–‡å­— */
        .survey-intro {
            padding: 24px;
            background-color: #fdfdfd;
            border-bottom: 1px solid #eee;
            font-size: 15px;
            line-height: 1.6;
        }

        /* å•å·è¡¨å–® */
        .survey-form {
            padding: 30px;
        }

        /* è¡¨å–®çš„ "éƒ¨åˆ†" (ä¾‹å¦‚: ç¬¬ä¸€éƒ¨åˆ†) */
        .form-section {
            margin-bottom: 30px;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }
        .form-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .form-section h2 {
            font-size: 20px;
            color: #0056b3;
            border-bottom: 2px solid #0056b3;
            padding-bottom: 8px;
            margin-bottom: 20px;
        }

        /* æ¯å€‹å•é¡Œå€å¡Š */
        .form-group {
            margin-bottom: 22px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
            font-size: 16px;
        }

        /* è¼¸å…¥æ¡† (æ–‡å­—) */
        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box; /* ç¢ºä¿ padding ä¸æœƒæ’é–‹å¯¬åº¦ */
            font-size: 16px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.15);
        }

        /* å»ºè­°æ–‡å­—å€ */
        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        /* é¸é …ç¾¤çµ„ (èº«åˆ†åˆ¥, å¹´è³‡) */
        .radio-vertical-group .radio-label {
            display: block;
            padding: 10px;
            margin-bottom: 5px;
            cursor: pointer;
        }
        .radio-vertical-group .radio-label:hover {
            background-color: #f9f9f9;
        }
        .radio-vertical-group input[type="radio"] {
            margin-right: 8px;
        }

        /* å…¶ä»– (æ–‡å­—æ¡†) */
        .other-input {
            margin-left: 30px;
            margin-top: 5px;
            width: 80%;
        }

        /* * æ»¿æ„åº¦é‡è¡¨ (Part 2 & 3)
         * ä½¿ç”¨ table ä¾†ç¢ºä¿å°é½Š 
        */
        .likert-container {
            width: 100%;
            overflow-x: auto; /* åœ¨å°è¢å¹•ä¸Šå¯ä»¥æ»‘å‹• */
            border: 1px solid #eee;
            border-radius: 8px;
        }

        .likert-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px; /* ç¢ºä¿åœ¨å°è¢å¹•ä¸Šä¸æœƒæ“ å£“ */
        }

        .likert-table th,
        .likert-table td {
            padding: 12px 10px;
            text-align: center;
            border-bottom: 1px solid #f0f0f0;
        }

        .likert-table thead th {
            background-color: #f8f8f8;
            font-size: 14px;
            color: #555;
        }

        .likert-table tbody td:first-child {
            text-align: left;
            font-weight: 500;
            padding-left: 16px;
            font-size: 15px;
            min-width: 250px; /* è®“é¡Œé …æ–‡å­—æœ‰è¶³å¤ ç©ºé–“ */
        }

        .likert-table tbody tr:hover {
            background-color: #fcfcfc;
        }

        .likert-table input[type="radio"] {
            cursor: pointer;
            transform: scale(1.1);
        }
        
        /* æŒ‡å°èª */
        .guidance-text {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
            background-color: #f9f9f9;
            padding: 10px;
            border-radius: 6px;
        }

        /* æäº¤æŒ‰éˆ• */
        .submit-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: #28a745; /* ç¶ è‰² */
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .submit-btn:hover {
            background-color: #218838;
        }
        
        /* ç•¶æŒ‰éˆ•åœ¨ "è¼‰å…¥ä¸­" æ™‚çš„æ¨£å¼ */
        .submit-btn:disabled {
            background-color: #94d3a2;
            cursor: not-allowed;
        }

        /* *ã€æ–°åŠ å…¥ã€‘: å½ˆå‡ºå¼è¨Šæ¯ (Modal) çš„æ¨£å¼ 
         */
        
        /* é®ç½©å±¤ (èƒŒæ™¯è®Šæš—) */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            z-index: 1000;
        }
        
        /* è¨Šæ¯æ¡†æœ¬äºº */
        .modal-content {
            background-color: white;
            padding: 30px 40px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s;
        }
        
        /* ç•¶ modal-overlay è®Šæˆ .show æ™‚ */
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-overlay.show .modal-content {
            transform: scale(1);
        }

        /* è¨Šæ¯æ¡†çš„æ¨™é¡Œ (ä¾‹å¦‚ "æˆåŠŸ" æˆ– "å¤±æ•—") */
        .modal-content h2 {
            margin-top: 0;
            font-size: 24px;
        }

        /* æˆåŠŸ (ç¶ è‰²) */
        .modal-content.success h2 {
            color: #28a745;
        }
        /* å¤±æ•— (ç´…è‰²) */
        .modal-content.error h2 {
            color: #dc3545;
        }
        
        /* è¨Šæ¯æ¡†çš„ "é—œé–‰" æŒ‰éˆ• */
        .modal-close-btn {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
        }
        .modal-close-btn:hover {
            background-color: #0056b3;
        }

    </style>
</head>
<body>

    <!-- é€™æ˜¯ HTML çµæ§‹ -->
    <div class="survey-container">
        
        <header class="survey-header">
            <h1>èª²ç¨‹æ»¿æ„åº¦æš¨å­¸ç¿’å›é¥‹å•å·</h1>
        </header>

        <div class="survey-intro">
            <p>è¦ªæ„›çš„åŒä»ï¼Œæ‚¨å¥½ï¼š</p>
            <p>æ„Ÿè¬æ‚¨åƒèˆ‡æœ¬æ¬¡ç”±æ•™å­¸éƒ¨èˆ‰è¾¦çš„èª²ç¨‹ã€‚ç‚ºç¢ºä¿æœªä¾†çš„èª²ç¨‹æ›´è²¼è¿‘åŒä»çš„éœ€æ±‚ä¸¦æŒçºŒæå‡å“è³ªï¼Œè«‹æ‚¨æ’¥å†—å¡«å¯«ä»¥ä¸‹å›é¥‹å•å·ã€‚æ‚¨çš„å¯¶è²´æ„è¦‹æ˜¯æˆ‘å€‘ä¸æ–·é€²æ­¥çš„å‹•åŠ›ï¼</p>
        </div>

        <form class="survey-form" id="surveyForm">
            
            <!-- 
                ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºæœ¬è³‡æ–™
            -->
            <section class="form-section">
                <h2>ğŸ“ ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºæœ¬è³‡æ–™</h2>

                <div class="form-group">
                    <label for="employeeId">äººäº‹è™Ÿ</label>
                    <input type="text" id="employeeId" name="employeeId" class="form-control" placeholder="è«‹è¼¸å…¥æ‚¨çš„äººäº‹è™Ÿ">
                </div>

                <div class="form-group">
                    <label for="name">å§“å</label>
                    <input type="text" id="name" name="name" class="form-control" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å" required>
                </div>

                <div class="form-group">
                    <label for="department">1. æ‚¨çš„æœå‹™å–®ä½/ç§‘åˆ¥</label>
                    <input type="text" id="department" name="department" class="form-control" placeholder="è«‹è¼¸å…¥æ‚¨çš„å–®ä½ç§‘åˆ¥" required>
                </div>

                <div class="form-group">
                    <label>2. æ‚¨çš„èº«åˆ†åˆ¥</label>
                    <div class="radio-vertical-group" id="identityGroup">
                        <label class="radio-label"><input type="radio" name="identity" value="é†«å¸«" required> é†«å¸«</label>
                        <label class="radio-label"><input type="radio" name="identity" value="é†«è­·äººå“¡"> é†«è­·äººå“¡ (å«è­·Lå¸«ã€å°ˆç§‘è­·ç†å¸«ç­‰)</label>
                        <label class="radio-label"><input type="radio" name="identity" value="é†«æŠ€äººå“¡"> é†«æŠ€äººå“¡ (å«è—¥/æª¢/æ”¾/å¾©å¥/ç‡Ÿé¤Šç­‰)</label>
                        <label class="radio-label"><input type="radio" name="identity" value="è¡Œæ”¿äººå“¡"> è¡Œæ”¿äººå“¡</label>
                        <label class="radio-label">
                            <input type="radio" name="identity" value="å…¶ä»–"> å…¶ä»–ï¼š
                            <input type="text" name="identity_other" class="form-control other-input" placeholder="è«‹èªªæ˜">
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label>3. æ‚¨çš„å·¥ä½œç¸½å¹´è³‡</label>
                    <div class="radio-vertical-group" id="yearsGroup">
                        <label class="radio-label"><input type="radio" name="workYears" value="0-3å¹´" required> 0-3 å¹´</label>
                        <label class="radio-label"><input type="radio" name="workYears" value="4-10å¹´"> 4-10 å¹´</label>
                        <label class="radio-label"><input type="radio" name="workYears" value="11å¹´ä»¥ä¸Š"> 11 å¹´ï¼ˆå«ï¼‰ä»¥ä¸Š</label>
                    </div>
                </div>
            </section>

            <!-- 
                ç¬¬äºŒéƒ¨åˆ†ï¼šèª²ç¨‹æ»¿æ„åº¦ 
            -->
            <section class="form-section">
                <h2>ğŸ“Š ç¬¬äºŒéƒ¨åˆ†ï¼šèª²ç¨‹æ»¿æ„åº¦ (å¿…å¡«)</h2>
                <p class="guidance-text">æŒ‡å°èªï¼š è«‹é‡å°æœ¬æ¬¡èª²ç¨‹çš„ã€Œè¬›å¸«ã€èˆ‡ã€Œå®‰æ’ã€çµ¦äºˆæ•´é«”è©•åˆ†ã€‚(5=éå¸¸åŒæ„, 4=åŒæ„, 3=æ™®é€š, 2=ä¸åŒæ„, 1=éå¸¸ä¸åŒæ„)</p>
                
                <div class="likert-container">
                    <table class="likert-table">
                        <thead>
                            <tr>
                                <th>é¡Œé …</th>
                                <th>éå¸¸åŒæ„(5)</th>
                                <th>åŒæ„(4)</th>
                                <th>æ™®é€š(3)</th>
                                <th>ä¸åŒæ„(2)</th>
                                <th>éå¸¸ä¸åŒæ„(1)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>4. è¬›å¸«å…·å‚™è±å¯Œçš„å°ˆæ¥­çŸ¥è­˜èˆ‡æ•™å­¸ç†±å¿±ã€‚</td>
                                <td><input type="radio" name="q4_knowledge" value="5" required></td>
                                <td><input type="radio" name="q4_knowledge" value="4"></td>
                                <td><input type="radio" name="q4_knowledge" value="3"></td>
                                <td><input type="radio" name="q4_knowledge" value="2"></td>
                                <td><input type="radio" name="q4_knowledge" value="1"></td>
                            </tr>
                            <tr>
                                <td>5. èª²ç¨‹æ•™æå…§å®¹èˆ‡æ´»å‹•å®‰æ’æº–å‚™å……åˆ†ã€‚</td>
                                <td><input type="radio" name="q5_material" value="5" required></td>
                                <td><input type="radio" name="q5_material" value="4"></td>
                                <td><input type="radio" name="q5_material" value="3"></td>
                                <td><input type="radio" name="q5_material" value="2"></td>
                                <td><input type="radio" name="q5_material" value="1"></td>
                            </tr>
                            <tr>
                                <td>6. èª²ç¨‹æ•™å­¸æ¸…æ™°æœ‰æ¢ç†ï¼Œèƒ½æŒæ¡é‡é»ã€‚</td>
                                <td><input type="radio" name="q6_clarity" value="5" required></td>
                                <td><input type="radio" name="q6_clarity" value="4"></td>
                                <td><input type="radio" name="q6_clarity" value="3"></td>
                                <td><input type="radio" name="q6_clarity" value="2"></td>
                                <td><input type="radio" name="q6_clarity" value="1"></td>
                            </tr>
                            <tr>
                                <td>7. èª²ç¨‹æ™‚é–“èˆ‡ç’°å¢ƒ(å«ç¡¬é«”è¨­å‚™)å®‰æ’é©ç•¶ã€‚</td>
                                <td><input type="radio" name="q7_env" value="5" required></td>
                                <td><input type="radio" name="q7_env" value="4"></td>
                                <td><input type="radio" name="q7_env" value="3"></td>
                                <td><input type="radio" name="q7_env" value="2"></td>
                                <td><input type="radio" name="q7_env" value="1"></td>
                            </tr>
                            <tr>
                                <td>8. æ•´é«”è€Œè¨€ï¼Œæˆ‘å°æœ¬æ¬¡èª²ç¨‹æ„Ÿåˆ°æ»¿æ„ã€‚</td>
                                <td><input type="radio" name="q8_overall" value="5" required></td>
                                <td><input type="radio" name="q8_overall" value="4"></td>
                                <td><input type="radio" name="q8_overall" value="3"></td>
                                <td><input type="radio" name="q8_overall" value="2"></td>
                                <td><input type="radio" name="q8_overall" value="1"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- 
                ç¬¬ä¸‰éƒ¨åˆ†ï¼šå­¸ç¿’èˆ‡æ‡‰ç”¨ 
            -->
            <section class="form-section">
                <h2>ğŸ“ˆ ç¬¬ä¸‰éƒ¨åˆ†ï¼šå­¸ç¿’èˆ‡æ‡‰ç”¨ (å¿…å¡«)</h2>
                <p class="guidance-text">è«‹è©•ä¼°æ‚¨åœ¨ã€Œå­¸ç¿’æˆæ•ˆã€èˆ‡ã€Œæœªä¾†æ‡‰ç”¨ã€æ–¹é¢çš„çœ‹æ³•ã€‚(5=éå¸¸åŒæ„, 4=åŒæ„, 3=æ™®é€š, 2=ä¸åŒæ„, 1=éå¸¸ä¸åŒæ„)</p>

                <div class="likert-container">
                    <table class="likert-table">
                        <thead>
                            <tr>
                                <th>é¡Œé …</th>
                                <th>éå¸¸åŒæ„(5)</th>
                                <th>åŒæ„(4)</th>
                                <th>æ™®é€š(3)</th>
                                <th>ä¸åŒæ„(2)</th>
                                <th>éå¸¸ä¸åŒæ„(1)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>9. èª²ç¨‹å…§å®¹ç¬¦åˆæˆ‘å€‹äººçš„å­¸ç¿’éœ€æ±‚ã€‚</td>
                                <td><input type="radio" name="q9_needs" value="5" required></td>
                                <td><input type="radio" name="q9_needs" value="4"></td>
                                <td><input type="radio" name="q9_needs" value="3"></td>
                                <td><input type="radio" name="q9_needs" value="2"></td>
                                <td><input type="radio" name="q9_needs" value="1"></td>
                            </tr>
                            <tr>
                                <td>10. æˆ‘èªç‚ºæˆ‘å·²é”æˆæœ¬èª²ç¨‹è¨­å®šçš„å­¸ç¿’ç›®æ¨™ã€‚</td>
                                <td><input type="radio" name="q10_goals" value="5" required></td>
                                <td><input type="radio" name="q10_goals" value="4"></td>
                                <td><input type="radio" name="q10_goals" value="3"></td>
                                <td><input type="radio" name="q10_goals" value="2"></td>
                                <td><input type="radio" name="q10_goals" value="1"></td>
                            </tr>
                            <tr>
                                <td>11. æœ¬èª²ç¨‹çš„å…§å®¹èˆ‡æˆ‘çš„å·¥ä½œå¯¦å‹™ç›¸é—œã€‚</td>
                                <td><input type="radio" name="q11_relevant" value="5" required></td>
                                <td><input type="radio" name="q11_relevant" value="4"></td>
                                <td><input type="radio" name="q11_relevant" value="3"></td>
                                <td><input type="radio" name="q11_relevant" value="2"></td>
                                <td><input type="radio" name="q11_relevant" value="1"></td>
                            </tr>
                            <tr>
                                <td>12. æˆ‘è¨ˆåŠƒå°‡æœ¬æ¬¡èª²ç¨‹æ‰€å­¸ï¼Œæ‡‰ç”¨æ–¼æˆ‘çš„æ—¥å¸¸å·¥ä½œä¸­ã€‚</td>
                                <td><input type="radio" name="q12_apply" value="5" required></td>
                                <td><input type="radio" name="q12_apply" value="4"></td>
                                <td><input type="radio" name="q12_apply" value="3"></td>
                                <td><input type="radio" name="q12_apply" value="2"></td>
                                <td><input type="radio" name="q12_apply" value="1"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- 
                ç¬¬å››éƒ¨åˆ†ï¼šè³ªæ€§å›é¥‹ 
            -->
            <section class="form-section">
                <h2>ğŸ’¡ ç¬¬å››éƒ¨åˆ†ï¼šè³ªæ€§å›é¥‹ (å¿…å¡«)</h2>

                <div class="form-group">
                    <label for="q13_insight">13. æœ¬æ¬¡èª²ç¨‹ä¸­ï¼Œè®“æ‚¨å°è±¡æœ€æ·±åˆ»æˆ–æœ€æœ‰å•Ÿç™¼çš„ä¸€å€‹è§€é»æˆ–æŠ€å·§æ˜¯ä»€éº¼ï¼Ÿ</label>
                    <textarea id="q13_insight" name="q13_insight" class="form-control" placeholder="è«‹åœ¨æ­¤å¡«å¯«..." required></textarea>
                </div>

                <div class="form-group">
                    <label for="q14_application">14. æ‰¿ä¸Šé¡Œï¼Œæ‚¨å…·é«”æ‰“ç®—å¦‚ä½•å°‡æ‰€å­¸æ‡‰ç”¨åœ¨å·¥ä½œä¸Šï¼Ÿ</label>
                    <textarea id="q14_application" name="q14_application" class="form-control" placeholder="è«‹åœ¨æ­¤å¡«å¯«..." required></textarea>
                </div>

                <div class="form-group">
                    <label for="q15_suggestion">15. å°æ–¼æœ¬èª²ç¨‹ï¼ˆä¾‹å¦‚ï¼šå…§å®¹æ·±åº¦ã€æ•™å­¸æ–¹å¼ã€æ™‚é–“å®‰æ’ç­‰ï¼‰ï¼Œæ‚¨æœ‰ä½•å…·é«”çš„æ”¹å–„å»ºè­°ï¼Ÿ</label>
                    <textarea id="q15_suggestion" name="q15_suggestion" class="form-control" placeholder="è«‹åœ¨æ­¤å¡«å¯«..." required></textarea>
                </div>
            </section>

            <!-- æäº¤æŒ‰éˆ• -->
            <div class="form-group">
                <button type="submit" class="submit-btn" id="submitBtn">æäº¤å•å·</button>
            </div>

        </form>

        <footer class="survey-footer">
            <p>ä¸»è¾¦å–®ä½ï¼šæ•™å­¸éƒ¨ | è¯çµ¡äººï¼šæ—æ·‘é›… (åˆ†æ©Ÿ57438ï¼›ä¿¡ç®±cmh90022@mail.chimei.org.tw)</p>
        </footer>
    </div>

    <!-- 
      ã€æ–°åŠ å…¥ã€‘: å½ˆå‡ºå¼è¨Šæ¯ (Modal) çš„ HTML çµæ§‹ 
      å®ƒä¸€é–‹å§‹æ˜¯éš±è—çš„
    -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-content" id="modalContent">
            <h2 id="modalTitle"></h2>
            <p id="modalMessage"></p>
            <button class="modal-close-btn" id="modalCloseBtn">é—œé–‰</button>
        </div>
    </div>


    <!-- 
      **********************************************
      * *
      * ã€æ­¥é©Ÿä¸‰ã€‘JavaScript æ ¸å¿ƒ            *
      * *
      **********************************************
    -->
    <script>
        // 1. æŠŠæ‚¨å‰›å‰›çµ¦æˆ‘çš„ Apps Script URL è²¼åœ¨é€™è£¡
        //    !! è­¦å‘Š !! è«‹å‹¿å¤–æ´©æ­¤ URLï¼Œå®ƒæ²’æœ‰é‡‘é‘°ä¿è­·
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxPnzKgvRT2nHA05pwVTksaibKcgtlmfOfXLIUbHyBndWbn5tvMY-NDpVVL3g0YpLEEkw/exec";

        // 2. ç²å–æˆ‘å€‘éœ€è¦æ“ä½œçš„ HTML å…ƒä»¶
        const form = document.getElementById('surveyForm');
        const submitBtn = document.getElementById('submitBtn');
        
        // ç²å– Modal (å½ˆå‡ºè¨Šæ¯) ç›¸é—œå…ƒä»¶
        const modalOverlay = document.getElementById('modalOverlay');
        const modalContent = document.getElementById('modalContent');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');
        const modalCloseBtn = document.getElementById('modalCloseBtn');

        // 3. ç›£è½è¡¨å–®çš„ "submit" (æäº¤) äº‹ä»¶
        form.addEventListener('submit', function(e) {
            
            // 4. (é‡è¦) é˜²æ­¢è¡¨å–®çš„é è¨­æäº¤è¡Œç‚º (ä¸è¦è®“é é¢è·³è½‰)
            e.preventDefault();

            // 5. é–å®šæŒ‰éˆ•ï¼Œé¡¯ç¤º "æäº¤ä¸­..."
            submitBtn.disabled = true;
            submitBtn.textContent = 'æäº¤ä¸­ï¼Œè«‹ç¨å€™...';

            // 6. ä½¿ç”¨ FormData ç²å–è¡¨å–®ä¸­çš„æ‰€æœ‰è³‡æ–™
            const formData = new FormData(form);

            // 7. ä½¿ç”¨ fetch APIï¼Œå°‡è³‡æ–™ "POST" åˆ°æ‚¨çš„ Apps Script ç¶²å€
            fetch(SCRIPT_URL, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json()) // å°‡ Apps Script çš„å›å‚³å€¼è½‰ç‚º JSON
            .then(data => {
                // 8. è™•ç† Apps Script çš„å›å‚³çµæœ
                if (data.result === 'success') {
                    // æˆåŠŸï¼
                    showModal('success', 'æäº¤æˆåŠŸï¼', 'æ„Ÿè¬æ‚¨çš„å¯¶è²´å›é¥‹ï¼Œå•å·å·²æˆåŠŸé€å‡ºã€‚');
                    form.reset(); // æ¸…ç©ºè¡¨å–®
                } else {
                    // å¤±æ•— (å¯èƒ½æ˜¯ Apps Script ç¨‹å¼ç¢¼å‡ºéŒ¯)
                    throw new Error(data.message || 'ç™¼ç”ŸæœªçŸ¥çš„éŒ¯èª¤');
                }
            })
            .catch(error => {
                // 9. è™•ç† fetch æœ¬èº«çš„éŒ¯èª¤ (ä¾‹å¦‚ç¶²è·¯æ–·ç·šï¼Œæˆ– CORS éŒ¯èª¤)
                console.error('Fetch éŒ¯èª¤:', error);
                showModal('error', 'æäº¤å¤±æ•—ï¼', 'ç„¡æ³•é€£æ¥åˆ°ä¼ºæœå™¨ï¼Œè«‹æª¢æŸ¥æ‚¨çš„ç¶²è·¯é€£ç·šï¼Œæˆ–ç¨å¾Œå†è©¦ã€‚');
            })
            .finally(() => {
                // 10. (ç„¡è«–æˆåŠŸæˆ–å¤±æ•—) éƒ½è¦æ¢å¾©æŒ‰éˆ•
                submitBtn.disabled = false;
                submitBtn.textContent = 'æäº¤å•å·';
            });
        });

        // 11. é¡¯ç¤º Modal (å½ˆå‡ºè¨Šæ¯) çš„è¼”åŠ©å‡½å¼
        function showModal(type, title, message) {
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            
            // ç§»é™¤èˆŠçš„ classï¼ŒåŠ ä¸Šæ–°çš„
            modalContent.classList.remove('success', 'error');
            modalContent.classList.add(type); // 'success' æˆ– 'error'
            
            // é¡¯ç¤º Modal
            modalOverlay.classList.add('show');
        }

        // 12. ç›£è½ Modal çš„ "é—œé–‰" æŒ‰éˆ•
        modalCloseBtn.addEventListener('click', function() {
            modalOverlay.classList.remove('show');
        });
        
        // (å¯é¸) é»æ“ŠèƒŒæ™¯é®ç½©æ™‚ä¹Ÿé—œé–‰
        modalOverlay.addEventListener('click', function(e) {
            if (e.target === modalOverlay) {
                modalOverlay.classList.remove('show');
            }
        });

    </script>

</body>
</html>
